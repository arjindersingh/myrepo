{% extends 'acbase.html' %}
{% load static %}
{% block header %}
{% include 'acheader.html' %}
{% endblock %}
{% include 'leftmenu.html' %}
{% block content %}
<h1>User Groups</h1>
<div class="row g-2 align-items-center mb-3">
  <div class="col-auto">
      <a href="{% url 'create_user_group' %}" class="btn btn-primary">
          Create New Group
      </a>
  </div>
  <div class="col">
      <input type="text" id="searchInput" 
             class="form-control" 
             placeholder="Search groups..." 
             onkeyup="searchTable()">
  </div>
  <div class="col-auto">
      <a href="{% url 'list_user_profiles' %}" class="btn btn-secondary">
          Users 
      </a>
  </div>
</div>

<table class="table table-striped mt-4">
  <thead>
    <tr>
      <th>Name</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody id="groupTable">
    {% for group in groups %}
      <tr>
        <td>{{ group.name }}</td>
        <td>
          <a href="{% url 'edit_user_group' group.pk %}" class="btn btn-warning btn-sm">Edit</a>
          <form action="{% url 'delete_group' group.pk %}" method="POST" style="display:inline;">
            {% csrf_token %}
            <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure you want to delete this group?');">Delete</button>
          </form>
          <a href="{% url 'manage_group_menu_permissions' group.pk %}" class="btn btn-warning btn-sm">Menu</a>
        </td>
      </tr>
    {% empty %}
      <tr>
        <td colspan="2">No groups found</td>
      </tr>
    {% endfor %}
  </tbody>
</table>

<script>
function searchTable() {
    let input = document.getElementById("searchInput").value.toLowerCase();
    let rows = document.querySelectorAll("#groupTable tr");

    rows.forEach(row => {
        let name = row.cells[0]?.textContent.toLowerCase() || "";
        row.style.display = name.includes(input) ? "" : "none";
    });
}
</script>

{% endblock %}
{% block footer %}
{% include 'acfooter.html' %}
{% endblock %}